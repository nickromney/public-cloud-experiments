# Sidecar Overlay - Combines oauth2-proxy and frontend into a single pod
#
# Multi-namespace architecture (sidecar variant):
#   - azure-auth-sim: Frontend + OAuth2-Proxy (sidecar), Backend API
#   - azure-entraid-sim: Keycloak (deployed separately via ArgoCD app)
#   - azure-apim-sim: APIM Simulator (deployed separately via ArgoCD app)
#
# Usage:
#   kubectl apply -k .
#   # OR
#   kubectl apply -f combined-sidecar-manifests.yaml
#
# Result: 2 pods in azure-auth-sim
#   - api-fastapi-keycloak
#   - frontend-with-oauth-sidecar (oauth2-proxy + frontend)
#
# ArgoCD Application config:
#   spec:
#     source:
#       path: apps/azure-auth-sim/overlays/sidecar
#
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

# Use the combined manifest directly
resources:
  - combined-sidecar-manifests.yaml
