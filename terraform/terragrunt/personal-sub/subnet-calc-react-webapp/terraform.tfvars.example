# Example configuration for the Subnet Calculator React Web App stack
# Copy to terraform.tfvars and update values as needed.

environment         = "dev"
project_name        = "subnetcalc"
workload_name       = "subnet-calculator-react-webapp"
resource_group_name = "rg-subnet-calc"

service_plans = {
  func = {
    name     = "plan-subnetcalc-dev-func"
    os_type  = "Linux"
    sku_name = "EP1"
  }
  web = {
    name     = "plan-subnetcalc-dev-web"
    os_type  = "Linux"
    sku_name = "B1"
  }
}

log_analytics_workspaces          = {}
shared_log_analytics_workspace_id = "/subscriptions/<sub-id>/resourceGroups/rg-subnet-calc/providers/Microsoft.OperationalInsights/workspaces/log-subnetcalc-shared-dev"

application_insights = {
  react = {
    name             = "appi-subnetcalc-react-webapp"
    application_type = "web"
  }
}

function_apps = {
  api = {
    name                 = "func-subnet-calc-react-api"
    service_plan_key     = "func"
    runtime              = "python"
    runtime_version      = "3.11"
    public_network_access_enabled = true
    app_insights_key     = "react"
    cors_allowed_origins = ["https://web-subnet-calc-react.azurewebsites.net"]
    app_settings = {
      AUTH_METHOD                     = "jwt"
      JWT_SECRET_KEY                  = "change-me"
      JWT_ALGORITHM                   = "HS256"
      JWT_ACCESS_TOKEN_EXPIRE_MINUTES = "30"
      JWT_TEST_USERS                  = "{}"
      AzureWebJobsFeatureFlags        = "EnableWorkerIndexing"
      SCM_DO_BUILD_DURING_DEPLOYMENT  = "true"
    }
  }
}

web_apps = {
  frontend = {
    name             = "web-subnet-calc-react"
    service_plan_key = "web"
    runtime          = "node"
    runtime_version  = "22-lts"
    startup_file     = "node server.js"
    always_on        = true
    app_insights_key = "react"
    app_settings = {
      STACK_NAME                     = "Subnet Calculator React"
      AUTH_METHOD                    = "jwt"
      WEBSITE_NODE_DEFAULT_VERSION   = "~22"
      SCM_DO_BUILD_DURING_DEPLOYMENT = "true"
      WEBSITE_RUN_FROM_PACKAGE       = "0"
      API_BASE_URL                   = ""
    }
  }
}
